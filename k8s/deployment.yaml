apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: swarm-arena\n  namespace: swarm-arena\n  labels:\n    app: swarm-arena\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: swarm-arena\n  template:\n    metadata:\n      labels:\n        app: swarm-arena\n    spec:\n      serviceAccountName: swarm-arena\n      containers:\n      - name: swarm-arena\n        image: swarm-arena:latest\n        imagePullPolicy: Always\n        ports:\n        - containerPort: 8765\n          name: websocket\n        - containerPort: 8080\n          name: http\n        env:\n        - name: SWARM_ARENA_ENV\n          value: \"production\"\n        - name: RAY_ADDRESS\n          value: \"ray://ray-head-service:10001\"\n        - name: REDIS_URL\n          valueFrom:\n            secretKeyRef:\n              name: swarm-arena-secrets\n              key: redis-url\n        resources:\n          requests:\n            memory: \"512Mi\"\n            cpu: \"250m\"\n          limits:\n            memory: \"2Gi\"\n            cpu: \"1000m\"\n        livenessProbe:\n          exec:\n            command:\n            - python\n            - -c\n            - \"import swarm_arena; print('OK')\"\n          initialDelaySeconds: 30\n          periodSeconds: 30\n        readinessProbe:\n          httpGet:\n            path: /health\n            port: 8080\n          initialDelaySeconds: 5\n          periodSeconds: 10\n        volumeMounts:\n        - name: data-volume\n          mountPath: /app/data\n        - name: logs-volume\n          mountPath: /app/logs\n      volumes:\n      - name: data-volume\n        persistentVolumeClaim:\n          claimName: swarm-arena-data\n      - name: logs-volume\n        persistentVolumeClaim:\n          claimName: swarm-arena-logs\n---\napiVersion: v1\nkind: Service\nmetadata:\n  name: swarm-arena-service\n  namespace: swarm-arena\nspec:\n  selector:\n    app: swarm-arena\n  ports:\n  - name: websocket\n    port: 8765\n    targetPort: 8765\n  - name: http\n    port: 8080\n    targetPort: 8080\n  type: LoadBalancer\n---\napiVersion: v1\nkind: ServiceAccount\nmetadata:\n  name: swarm-arena\n  namespace: swarm-arena\n---\napiVersion: v1\nkind: PersistentVolumeClaim\nmetadata:\n  name: swarm-arena-data\n  namespace: swarm-arena\nspec:\n  accessModes:\n    - ReadWriteOnce\n  resources:\n    requests:\n      storage: 10Gi\n---\napiVersion: v1\nkind: PersistentVolumeClaim\nmetadata:\n  name: swarm-arena-logs\n  namespace: swarm-arena\nspec:\n  accessModes:\n    - ReadWriteOnce\n  resources:\n    requests:\n      storage: 5Gi"